<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Central Fuel Plan Dashboard</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="dashboard">
      <div class="dashboard-header">
        <div class="header-content">
          <img
            src="https://cdn.builder.io/api/v1/image/assets%2Fbd65b3cd7a86452e803a3d7dc7a3d048%2Fc540452a3db046ac922bafa84f938adc?format=webp&width=800"
            alt="STC Logo"
            class="logo logo-left"
          />
          <h1 class="header-title">Central Fuel Plan Dashboard</h1>
          <img
            src="https://cdn.builder.io/api/v1/image/assets%2Fbd65b3cd7a86452e803a3d7dc7a3d048%2F2a2ac0238b1444ef9a1b89619ad94b40?format=webp&width=400"
            alt="ACES Managed Services Logo"
            class="logo"
          />
        </div>
      </div>
      <div class="left-panel">
        <div class="search-bar-container">
          <input
            type="text"
            id="searchInput"
            class="search-bar"
            placeholder="Search by Site Name..."
          />
          <button id="downloadBtn" class="download-btn" onclick="downloadExcel()">ðŸ“¥ Download Excel</button>
        </div>

        <div class="metrics-grid">
          <div class="metric-box">
            <div class="metric-label">Total Sites</div>
            <div class="metric-value" id="totalSites">0</div>
          </div>
          <div class="metric-box">
            <div class="metric-label">Due (Overdue)</div>
            <div class="metric-value due" id="dueSites">0</div>
          </div>
          <div class="metric-box">
            <div class="metric-label">Today</div>
            <div class="metric-value today-metric" id="todaySites">0</div>
          </div>
          <div class="metric-box">
            <div class="metric-label">Next 3-15 Days</div>
            <div class="metric-value future" id="futureSites">0</div>
          </div>
        </div>

        <div class="cards-container">
          <div class="status-card overdue-card">
            <h3>Due (Overdue)</h3>
            <table class="sites-table">
              <thead>
                <tr>
                  <th>Site Name</th>
                  <th>Days</th>
                </tr>
              </thead>
              <tbody id="overdueTableBody"></tbody>
            </table>
          </div>

          <div class="status-card today-card">
            <h3>Today Schedule</h3>
            <table class="sites-table">
              <thead>
                <tr>
                  <th>Site Name</th>
                  <th>Date</th>
                </tr>
              </thead>
              <tbody id="todayTableBody"></tbody>
            </table>
          </div>

          <div class="status-card coming-card">
            <h3>Coming in 3 Days</h3>
            <table class="sites-table">
              <thead>
                <tr>
                  <th>Site Name</th>
                  <th>Days</th>
                </tr>
              </thead>
              <tbody id="comingTableBody"></tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="right-panel">
        <div id="map" class="map-container"></div>
      </div>
    </div>

    <div id="searchModal" class="search-modal">
      <div class="search-modal-content">
        <button class="search-modal-close" onclick="closeSearchModal()">
          &times;
        </button>
        <div id="searchResult" class="search-result">
          <!-- Results displayed here -->
        </div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
